### 查看网络
```shell script
[root@node01 ~]# ifconfig
calid120b41f6be: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1450
        inet6 fe80::ecee:eeff:feee:eeee  prefixlen 64  scopeid 0x20<link>
        ether ee:ee:ee:ee:ee:ee  txqueuelen 0  (Ethernet)
        RX packets 11  bytes 829 (829.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 11  bytes 927 (927.0 B)
        TX errors 0  dropped 16 overruns 0  carrier 0  collisions 0

docker0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:48:73:cb:a7  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

ens192: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.1.1.201  netmask 255.255.255.0  broadcast 10.1.1.255
        inet6 fe80::250:56ff:fea1:6020  prefixlen 64  scopeid 0x20<link>
        ether 00:50:56:a1:60:20  txqueuelen 1000  (Ethernet)
        RX packets 310157  bytes 339343633 (323.6 MiB)
        RX errors 0  dropped 169  overruns 0  frame 0
        TX packets 134604  bytes 21381461 (20.3 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 31930  bytes 2362697 (2.2 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 31930  bytes 2362697 (2.2 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

vxlan.calico: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1450
        inet 172.16.201.0  netmask 255.255.255.255  broadcast 0.0.0.0
        inet6 fe80::6452:12ff:fede:f182  prefixlen 64  scopeid 0x20<link>
        ether 66:52:12:de:f1:82  txqueuelen 0  (Ethernet)
        RX packets 11  bytes 829 (829.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 11  bytes 927 (927.0 B)
        TX errors 0  dropped 16 overruns 0  carrier 0  collisions 0
```

### 查看路由
```shell script
[root@node01 ~]# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
# 默认路由
0.0.0.0         10.1.1.254      0.0.0.0         UG    100    0        0 ens192
# 直连路由
10.1.1.0        0.0.0.0         255.255.255.0   U     100    0        0 ens192
# 直连的pod路由
172.16.201.0    0.0.0.0         255.255.255.0   U     0      0        0 *
172.16.201.1    0.0.0.0         255.255.255.255 UH    0      0        0 calid120b41f6be
# 其他node内pod的路由
172.16.202.0    172.16.202.0    255.255.255.0   UG    0      0        0 vxlan.calico
172.16.203.0    172.16.203.0    255.255.255.0   UG    0      0        0 vxlan.calico
# 原生的docker0
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0
```

### 建议删除pod calico-kube-controllers-749bc89dc9-dd7rl 让他重新获取地址

### 容器内部路由
```shell script
[root@master01 ~]# kubectl get pod -o wide
NAME                         READY   STATUS    RESTARTS   AGE   IP             NODE                    NOMINATED NODE   READINESS GATES
qyt-lb-dp-7f677cd4cf-phdj4   1/1     Running   0          10m   172.16.203.1   node03.qytanghost.com   <none>           <none>
qyt-lb-ds-9kdfc              1/1     Running   0          10m   172.16.201.1   node01.qytanghost.com   <none>           <none>
qyt-lb-ds-n75kn              1/1     Running   0          10m   172.16.202.1   node02.qytanghost.com   <none>           <none>
qyt-lb-ds-qdnk6              1/1     Running   0          10m   172.16.203.2   node03.qytanghost.com   <none>           <none>

[root@master01 ~]# kubectl exec -it qyt-lb-dp-7f677cd4cf-phdj4 -- /bin/bash
[root@qyt-lb-dp-7f677cd4cf-phdj4 qytang]# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         169.254.1.1     0.0.0.0         UG    0      0        0 eth0
169.254.1.1     0.0.0.0         255.255.255.255 UH    0      0        0 eth0
```

### Node上测试网络 (Node01)
```shell script
[root@node01 ~]# ping 172.16.201.1

[root@node01 ~]# ping 172.16.202.1

[root@node01 ~]# ping 172.16.203.1
[root@node01 ~]# ping 172.16.203.2
```

### Pod内测试 (任何一个Master)
```shell script
[root@master01 ~]# kubectl exec -it qyt-lb-dp-7f677cd4cf-phdj4 -- /bin/bash

[root@qyt-lb-dp-7f677cd4cf-phdj4 qytang]# ping 172.16.201.1

[root@qyt-lb-dp-7f677cd4cf-phdj4 qytang]# ping 172.16.202.1

[root@qyt-lb-dp-7f677cd4cf-phdj4 qytang]# ping 172.16.203.1
[root@qyt-lb-dp-7f677cd4cf-phdj4 qytang]# ping 172.16.203.2
```

### Pod curl测试 查看访问源地址 (Master)
```shell script
# master01
[root@master01 ~]# kubectl exec -it qyt-lb-dp-7f677cd4cf-phdj4 -- /bin/bash
[root@qyt-lb-dp-7f677cd4cf-phdj4 qytang]# curl 172.16.202.1:5000
This is qyt-lb-ds-n75kn, My IP is 172.16.202.1

# master02
[root@master01 ~]# kubectl exec -it qyt-lb-ds-n75kn -- /bin/bash
[root@qyt-lb-ds-n75kn qytang]# yum install -y tcpdump
[root@qyt-lb-ds-n75kn qytang]# tcpdump -n
真实地址互相访问
13:30:49.278992 IP 172.16.203.1.35506 > 172.16.202.1.commplex-main: Flags [S], seq 3908567424, win 28200, options [mss 1410,sackOK,TS val 3657137926 ecr 0,nop,wscale 7], length 0
13:30:49.279042 IP 172.16.202.1.commplex-main > 172.16.203.1.35506: Flags [S.], seq 143737868, ack 3908567425, win 27960, options [mss 1410,sackOK,TS val 708364601 ecr 3657137926,nop,wscale 7], length 0
```